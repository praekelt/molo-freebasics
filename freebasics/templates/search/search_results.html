{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags i18n%}

{% block content %}
{% if search_results %}
<div class="block-search fb-body fb-card">
  <h6 class="block-heading fb-accent-1">Search Results</h6>
  <h6 class="sub-heading">Search Results for {{search_query}}</h6>

  {% for page in search_results %}
  <ul class="list-block">
    {% with parent_section=page.get_parent_section ancestor=page.get_parent_section.get_ancestors.last %}
    {% if ancestor.sectionpage.image %}
    <li>
          <h6 class="fb-accent-2">{{ancestor.title}}</h6>
          <p>{{page.title}}</p>
    </li>
    {% else %}
    <li>
          <h6 class="fb-accent-2">{{parent_section.title}}</h6>
          <p>{{page.title}}</p>
          <a href={{page.url}} class="fb-accent-2 link-button">View</a>
    </li>
    {% endif %}
    {% endwith %}
  </ul>
  {% endfor %}
</div>

  <div class="step-links">
    {% if search_results.has_previous %}
        <a href="?p={{ search_results.previous_page_number }}&amp;q={{search_query}}">&larr;</a>
    {% endif %}
    <span class="current">
        Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}
    </span>
    {% if search_results.has_next %}
        <a href="?p={{ search_results.next_page_number }}&amp;q={{search_query}}">&rarr;</a>
    {% endif %}
  </div>

  {% else %}
      <div class="block-search fb-body fb-card">
        <h6 class="block-heading fb-accent-1">Search Results</h6>
        <h6 class="sub-heading">No search results for: {{search_query}}</h6>
        <div class="nav">
            <form action="{% url 'search' %}">
              <input placeholder="{% trans "I am looking for" %}" name="q" type="search">
              <input type="submit" value="{% trans "Search"%}" class="flatbutton">
            </form>
        </div>
    </div>
  {% endif %}
{% endblock %}

{% block search %}
  {% if search_results %}
      {% include "search/search_block.html" %}
  {% endif %}
{% endblock %}
